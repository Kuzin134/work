(function(m){var l=window.AmazonUIPageJS||window.P,n=l._namespace||l.attributeErrors,q=n?n("BrandFollowButtonJS",""):l;q.guardFatal?q.guardFatal(m)(q,window):q.execute(function(){m(q,window)})})(function(m,l,n){var q="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},z=function(){function g(c,a){for(var e=0;e<a.length;e++){var f=a[e];f.enumerable=
f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(c,f.key,f)}}return function(c,a,e){a&&g(c.prototype,a);e&&g(c,e);return c}}();m.when("A").register("brand-follow-constants",function(){return{PAGE_LOCALE:l.top.document.documentElement.lang,Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR:"span[class*\x3dbrand-follow-button-container]",Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR:"span[class*\x3dbrand-follow-button]",Brand_FOLLOW_BUTTON_SELECTOR:"button[data-bfid]",Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR:'button[data-bfid][data-showtooltip\x3d"true"]',
BRAND_FOLLOW_STATUS_MAP:"brand-follow-status",BRAND_FOLLOW_STATUS:{FOLLOWING:"following",NOT_FOLLOWING:"not_following",PENDING:"pending",NOT_SIGNED_IN:"not_signed_in",ERROR:"error"},BRAND_FOLLOW_CSRF_KEY:"brand-follow-csrf",BRAND_FOLLOW_CSRF_DATA_KEY:"csrf",BRAND_FOLLOW_LAST_CLICK_EVENT_MAP:"brand-follow-last-click-event-map",BFID_DATA_KEY:"bfid",REF_DATA_KEY:"ref",FOLLOW_STATUS_DATA_KEY:"followstatus",FOLLOW_TEXT_DATA_KEY:"followtext",FOLLOWING_TEXT_DATA_KEY:"followingtext",REQUEST_ID_DATA_KEY:"requestid",
PLACEMENT_TYPE_DATA_KEY:"placementtype",PLACEMENT_SUB_TYPE_DATA_KEY:"placementsubtype",PLACEMENT_ID_DATA_KEY:"placementid",COMPONENT_TYPE_DATA_KEY:"componenttype",COMPONENT_ID_DATA_KEY:"componentid",ELEMENT_TYPE_DATA_KEY:"elementtype",ELEMENT_ID_DATA_KEY:"elementid",TOOLTIP_TEXT_DATA_KEY:"tooltiptext",BACK_BUTTON_SUPPORT_ENABLED_DATA_KEY:"backbuttonsupportenabled",ARIA_LABEL_KEY:"aria-label",ARIA_LABEL_FOLLOW_DATA_KEY:"arialabelfollow",ARIA_LABEL_FOLLOWING_DATA_KEY:"arialabelfollowing",FOLLOWED_BRAND_TOOLTIP_SIGNAL:"followed_brand_signal",
TOOLTIP_LAST_SEEN_KEY:"tooltip_last_seen",TOOLTIP_LATEST_TEXT_KEY:"tooltip_latest_text",TOOLTIP_SEEN_COUNTER:"tooltip_seen_counter",TOOLTIP_DISPLAY_TIME:5E3,TOOLTIP_STATUS_SHOWN:"SHOWN",TOOLTIP_STATUS_NOT_SHOWN:"NOT_SHOWN",TOOLTIP_STATUS_DISABLED:"DISABLED",FOLLOW_AJAX_TIMEOUT:2E3,FOLLOW_AJAX_RETRIES:2,FOLLOW_ENDPOINT:"/followv2/follow",FOLLOW_ENTITY_TYPE:"brand",FOLLOW_REF_TAG:"bsn_as_follow",FOLLOW_CSM_PREFIX:"BrandFollow",FOLLOW_CSM_SUCCESS:"Success",FOLLOW_CSM_FAIL:"Fail",FOLLOW_CSM_FOLLOW:"Follow",
FOLLOW_CSM_UNFOLLOW:"Unfollow",FOLLOW_CSM_GET_FOLLOW_STATUS:"GetFollowStatus",HTTP_GET:"GET",HTTP_POST:"POST",HTTP_DELETE:"DELETE",SIGN_IN_PORTAL:"/ap/signin",AUTH_PORTAL_ASSOC_HANDLE:{"amazon.com":"usflex","amazon.ca":"caflex","amazon.com.mx":"mxflex","amazon.com.br":"brflex","amazon.com.co":"coflex","amazon.cl":"clflex","amazon.co.uk":"gbflex","amazon.de":"deflex","amazon.es":"esflex","amazon.fr":"frflex","amazon.in":"inflex","amazon.it":"itflex","amazon.ae":"aeflex","amazon.sa":"saflex","amazon.nl":"nlflex",
"amazon.com.be":"beflex","amazon.co.za":"zaflex","amazon.com.ng":"ngflex","amazon.co.jp":"jpflex","amazon.com.au":"auflex","amazon.sg":"sgflex"},BREAKPOINTS:{MOBILE:840},SUSHI_ENDPOINT:{gamma:"https://unagi-na.amazon.com/1/events/com.amazon.eel.BrandFollowButtonMetrics.Gamma.ClientEvents",prod:"https://unagi-na.amazon.com/1/events/com.amazon.eel.BrandFollowButtonMetrics.Prod.ClientEvents"},EVENT_TYPE:{FOLLOW:"Follow",UNFOLLOW:"Unfollow"}}});"use strict";m.when("A","brand-follow-constants").register("brand-follow-auth-portal-link-builder",
function(g,c){return{signin:function(){var a={"openid.ns":"http://specs.openid.net/auth/2.0","openid.claimed_id":"http://specs.openid.net/auth/2.0/identifier_select","openid.identity":"http://specs.openid.net/auth/2.0/identifier_select","openid.mode":"checkid_setup","openid.return_to":l.location.href,"openid.assoc_handle":c.AUTH_PORTAL_ASSOC_HANDLE[l.location.hostname.replace(/.+?(?=amazon)/,"")]};return c.SIGN_IN_PORTAL+"?"+g.$.param(a)}}});"use strict";m.register("brand-follow-csm-helper",function(){return{incrementCSMCounter:function(g,
c){l.ue&&l.ue.count&&l.ue.count(g,(l.ue.count(g)||0)+1,c)},logBodyBegin:function(g){"function"==typeof uet&&uet("bb",g,{wb:1})},sendCsmMetrics:function(g){"function"==typeof uex&&uex("ld",g,{wb:1})}}});"use strict";m.when("A","brand-follow-constants","brand-follow-csm-helper").register("brand-follow-data-storage-helper",function(g,c,a){var e={set:function(a,c,e){var h={};h[c]=e;g.state(a,h)},get:function(a){return g.state(a)},setFollowStatus:function(a,h){e.set(c.BRAND_FOLLOW_STATUS_MAP,a,h)},getFollowStatus:function(a){var h=
e.get(c.BRAND_FOLLOW_STATUS_MAP);return h===n?n:h[a]},setLastClickEvent:function(a,h){e.set(c.BRAND_FOLLOW_LAST_CLICK_EVENT_MAP,a,h)},getLastClickEvent:function(f){var h=c.FOLLOW_CSM_PREFIX+":dataStorageHelper:getLastClickAction";a.incrementCSMCounter(h);var p=e.get(c.BRAND_FOLLOW_LAST_CLICK_EVENT_MAP);if(p===n)return a.incrementCSMCounter(h+":emptyMap"),n;(f=p[f])||a.incrementCSMCounter(h+":notFoundInMap");return f},setCsrf:function(a){e.set(c.BRAND_FOLLOW_CSRF_KEY,c.BRAND_FOLLOW_CSRF_DATA_KEY,a)},
getCsrf:function(){var a=e.get(c.BRAND_FOLLOW_CSRF_KEY);return a===n?n:a[c.BRAND_FOLLOW_CSRF_DATA_KEY]}};return e});"use strict";m.when("A","brand-follow-constants","brand-follow-data-storage-helper","brand-follow-csm-helper").register("brand-follow-afs-helper",function(g,c,a,e){var f={makeCallToAfs:function(a,p,f,b,d,u){var h=c.FOLLOW_CSM_PREFIX+":"+a;e.incrementCSMCounter(h);(function t(k){e.logBodyBegin(u);g.$.ajax({url:p,type:a,headers:{Accept:"application/json","Content-Type":"application/json"},
data:f,dataType:"json",cache:!1,timeout:c.FOLLOW_AJAX_TIMEOUT,success:function(a,d,f){e.incrementCSMCounter(h+":"+c.FOLLOW_CSM_SUCCESS);e.sendCsmMetrics(u);"function"===typeof b&&b(a,d,f)},error:function(b,f,p){if("timeout"===f&&k)e.incrementCSMCounter(h+":timeout"),t(--k);else{var g=h+":"+c.FOLLOW_CSM_FAIL;e.incrementCSMCounter(g);"timeout"===f&&e.incrementCSMCounter(g+":timeout");e.sendCsmMetrics(u);l.ueLogError&&l.ueLogError({logLevel:"WARN",attribution:"BrandFollowKataComponentAssets",message:"AFS "+
a+" call failed with status "+f+", error thrown: "+p+", response text: "+b.responseText});"function"===typeof d&&d(b,f,p)}}})})(c.FOLLOW_AJAX_RETRIES)},getFollowStatusAndInitCsrf:function(e,p,g,b,d){f.makeCallToAfs(c.HTTP_GET,c.FOLLOW_ENDPOINT+"/"+e+"_"+c.FOLLOW_ENTITY_TYPE,{ref:p},function(b,c,e){b.signedIn?(a.setCsrf(b.csrf),"function"===typeof g&&g(b)):"function"===typeof d&&d()},b,c.FOLLOW_CSM_PREFIX+":"+c.FOLLOW_CSM_GET_FOLLOW_STATUS)},follow:function(e,p,g,b,d){var h=c.FOLLOW_CSM_PREFIX+":"+
c.FOLLOW_CSM_FOLLOW,k=function(){f.makeCallToAfs(c.HTTP_POST,c.FOLLOW_ENDPOINT,JSON.stringify({authenticity_token:a.getCsrf(),entity_id:e,category:c.FOLLOW_ENTITY_TYPE,ref:p}),g,b,h)};a.getCsrf()===n?f.getFollowStatusAndInitCsrf(e,p,k,n,d):k()},unfollow:function(e,p,k,b){var d=c.FOLLOW_CSM_PREFIX+":"+c.FOLLOW_CSM_UNFOLLOW,h=function(){f.makeCallToAfs(c.HTTP_DELETE,c.FOLLOW_ENDPOINT+"/"+e+"_"+c.FOLLOW_ENTITY_TYPE+"?"+g.$.param({authenticity_token:a.getCsrf(),ref:p}),n,k,b,d)};a.getCsrf()===n?f.getFollowStatusAndInitCsrf(e,
p,h):h()}};return f});"use strict";m.when("A").register("brand-follow-button-tooltip-factory",function(g){g=g.$;var c=g("\x3cdiv class\x3d'brand-follow-tooltip-root'/\x3e").appendTo("body");return{getOrCreateTooltip:function(){0===c.children().length&&c.append("\x3cdiv role\x3d'tooltip' class\x3d'bf-tooltip' id\x3d'bf-tooltip' aria-hidden\x3d'true' style\x3d'z-index: 299; display: none;'\x3e\x3cdiv class\x3d'bf-tooltip-inner'\x3eFollow to get deals, content, and email updates from this brand.\x3c/div\x3e\x3cdiv class\x3d'bf-arrow-border'\x3e\x3cdiv class\x3d'bf-arrow'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");
return c.children().first()}}});"use strict";m.when("A").register("brand-follow-button-tooltip-position",function(g){function c(){if(1===g.viewport().zoom)return{top:0,left:0};k||(k=p('\x3cspan id\x3d"bf-tooltip-offset-tracker"\x3e\x3c/span\x3e'),p("body").prepend(k));var a;p.withoutRtl(function(){a=k.offset()});return a}function a(a,d){var b=g.viewport(),e=c(),h,f;p.withoutRtl(function(){h=d.offset();f=a.offset()});h.top-=e.top;h.left-=e.left;f.top-=e.top;f.left-=e.left;var k=d.outerWidth(),l=d.outerHeight(),
m=a.outerWidth(!0),n=a.outerHeight(!0);return{windowWidth:b.width,windowHeight:b.height,windowTop:b.scrollTop,windowLeft:b.scrollLeft,windowRight:b.scrollLeft+b.width,windowBottom:b.scrollTop+b.height,zoomTop:e.top,zoomLeft:e.left,triggerWidth:k+1,triggerHeight:l,triggerTop:h.top-1,triggerLeft:h.left-1,triggerRight:h.left+k+1,triggerBottom:h.top+l+1,triggerVerticalCenter:h.top+l/2,triggerHorizontalCenter:h.left+k/2,popoverWidth:m,popoverHeight:n,popoverTop:f.top,popoverLeft:f.left,popoverRight:f.left+
m,popoverBottom:f.top+n,popoverVerticalCenter:f.top+n/2,popoverHorizontalCenter:f.left+m/2}}function e(a){return a.removeClass("a-arrow-top a-arrow-bottom a-arrow-left a-arrow-right")}function f(a){var b={deltaTop:0};b.top=a.triggerVerticalCenter-a.popoverHeight/2;if(b.top<a.windowTop+15){var e=Math.min(a.windowTop+15,a.triggerTop-15);b.deltaTop=b.top-e;b.top=e}else b.top+a.popoverHeight>a.windowBottom-15&&(e=Math.min(15,a.windowBottom-a.triggerBottom+15),b.deltaTop=b.top+a.popoverHeight-(a.windowBottom-
e),b.top=a.windowBottom-e-a.popoverHeight);return b}function h(a){var b={deltaLeft:0};b.left=a.triggerHorizontalCenter-a.popoverWidth/2;if(15>b.left){var e=Math.min(15,a.triggerLeft-15);b.deltaLeft=b.left-e;b.left=e}else b.left+a.popoverWidth>a.windowRight-15&&(e=Math.min(15,a.windowRight-a.triggerRight+15),b.deltaLeft=b.left+a.popoverWidth-(a.windowRight-e),b.left=a.windowRight-e-a.popoverWidth);return b}var p=g.$;p(l);var k=null;return{windowCenter:function(b){b=a(b.$popover,b.$trigger);var d={};
d.top=(b.windowHeight-b.popoverHeight)/2;d.left=(b.windowWidth-b.popoverWidth)/2;0>d.top&&(d.top=0);return d},windowTop:function(b){b=a(b.$popover,b.$trigger);var d={top:0};d.left=b.windowWidth/2-b.popoverWidth/2;return d},windowFullWidth:function(a){return{top:0,left:0}},triggerRight:function(b,d){var c=b.$popover;b=b.$trigger;d||(d=a(c,b));b=f(d);b.left=d.triggerRight;e(c).addClass("a-arrow-right");c.find(".bf-arrow-border").css("top",d.popoverHeight/2+b.deltaTop);return b},triggerLeft:function(b,
d){var c=b.$popover;b=b.$trigger;d||(d=a(c,b));b=f(d);b.left=d.triggerLeft-d.popoverWidth;b.left=0<b.left?b.left:0;e(c).addClass("a-arrow-left");c.find(".bf-arrow-border").css("top",d.popoverHeight/2+b.deltaTop);return b},triggerTop:function(b,d){var c=b.$popover;b=b.$trigger;d||(d=a(c,b));b=h(d);b.top=d.triggerTop-d.popoverHeight;e(c).addClass("a-arrow-top");c.find(".bf-arrow-border").css("left",d.popoverWidth/2+b.deltaLeft);return b},triggerBottom:function(b,d){var c=b.$popover;b=b.$trigger;d||
(d=a(c,b));b=h(d);b.top=d.triggerBottom;e(c).addClass("a-arrow-bottom");c.find(".bf-arrow-border").css("left",d.popoverWidth/2+b.deltaLeft);return b},triggerHorizontal:function(b,d){var c=b.$popover,e=b.$trigger;d||(d=a(c,e));return d.triggerLeft-d.windowLeft>d.windowRight-d.triggerRight?this.triggerLeft(b,d):this.triggerRight(b,d)},triggerVertical:function(b,d){var c=b.$popover,e=b.$trigger;d=d?d:a(c,e);return d.triggerTop-d.windowTop>d.popoverHeight+15?this.triggerTop(b,d):this.triggerBottom(b,
d)},triggerVerticalAlignLeft:function(b,d){var c=b.$popover;b=b.$trigger;d||(d=a(c,b));b={};var h=0,f=0,g=d.windowBottom-d.triggerBottom;b.left=d.triggerLeft;b.top=g>d.popoverHeight?d.triggerBottom+3:d.triggerTop-d.popoverHeight-3;15>b.left?(f=Math.min(15,d.triggerLeft-15),h=b.left-f,b.left=f):b.left+d.popoverWidth>d.windowRight-15&&(f=Math.min(15,d.windowRight-d.triggerRight+15),h=b.left+d.popoverWidth-(d.windowRight-f),b.left=d.windowRight-f-d.popoverWidth);e(c).addClass(g>d.popoverHeight?"a-arrow-bottom":
"a-arrow-top");p.withoutRtl(function(){c.find(".bf-arrow-border").css("left",d.triggerWidth/2+h)});return b},triggerBottomAlignRight:function(b,d){var c=b.$popover;b=b.$trigger;d||(d=a(c,b));b={};var h=0,f=0,g=d.windowBottom-d.triggerBottom;b.left=d.triggerRight-d.popoverWidth;b.top=d.triggerBottom+3;15>b.left?(f=Math.max(0,b.left),h=f-b.left,b.left=f):b.left+d.popoverWidth>d.windowRight-15&&(f=Math.min(15,d.windowRight-d.triggerRight+15),h=b.left+d.popoverWidth-(d.windowRight-f),b.left=d.windowRight-
f-d.popoverWidth);e(c).addClass(g>d.popoverHeight?"a-arrow-bottom":"a-arrow-top");p.withoutRtl(function(){c.find(".bf-arrow-border").css("right",d.triggerWidth/2+h)});return b},customPosition:function(b,c){return c.call(this,{popover:b,$popover:b.$popover,$trigger:b.$trigger,measure:a})}}});"use strict";m.when("A","brand-follow-button-tooltip-factory","brand-follow-button-tooltip-position","brand-follow-constants").register("brand-follow-button-tooltip",function(g,c,a,e){var f=g.$;return{show:function(h){var g=
c.getOrCreateTooltip(),k=f(h);h=k.data(e.TOOLTIP_TEXT_DATA_KEY);k=a.triggerBottomAlignRight({$popover:g,$trigger:k});h&&g.find(".bf-tooltip-inner").first().text(h);g.css({top:k.top+"px",left:k.left+6+"px"});g.fadeIn(500)},hide:function(){c.getOrCreateTooltip().fadeOut(500)},getText:function(){return c.getOrCreateTooltip().find(".bf-tooltip-inner").first().text()}}});"use strict";m.register("brand-follow-sushi-client",function(){var g=["messageId","timestamp"];return function(){function c(a,e){if(!(this instanceof
c))throw new TypeError("Cannot call a class as a function");this.endpoint=e;this.window=a;this.eventsQueue=[];this.eventsDictionary={};this.reverseEventsDictionary={};this.eventSequence=this.lowPriorityTimer=this.highPriorityTimer=this.rejectedEvents=this.dictionaryIndex=this.batchSize=0;this.unloadHandlerCalled=!1;this.highPriorityFlushInterval=1E3;this.lowPriorityFlushInterval=1E4;this.transportationClient=function(c){var e=function(){};c=function(){var c=function(){if(a.XDomainRequest){var b=new a.XDomainRequest;
b.onerror=e;b.ontimeout=e;b.onprogress=e;b.onload=e;b.timeout=0;return b}if(a.XMLHttpRequest){b=new a.XMLHttpRequest;if(!("withCredentials"in b))throw"";return b}return null};return{send:function(a,d){if(d&&a){var b=c();if(!b)throw"";b.open("POST",a,!0);b.setRequestHeader&&b.setRequestHeader("Content-type","text/plain");b.send(d)}},isSupported:!0}}();var f=function(){return{send:function(c,b){if(c&&b&&!a.navigator.sendBeacon(c,b))throw"";},isSupported:!!a.navigator.sendBeacon&&!(a.cordova&&a.cordova.platformId&&
"ios"===a.cordova.platformId)}}();return{ajaxClient:c,beaconClient:f}}(this);this.compressor=function(a){var c=function(b){if(b)switch("undefined"===typeof b?"undefined":q(b)){case "number":return!(b!==b||Infinity===b)&&b.toString().length>a.dictionaryIndex.length;case "boolean":break;case "string":return b.length>a.dictionaryIndex.length;default:return!0}return!1},e=function(b){a.eventsDictionary[b]||(a.eventsDictionary[b]=a.dictionaryIndex++,a.reverseEventsDictionary[a.eventsDictionary[b]]=b);return a.eventsDictionary[b]},
f=function(a){if(c(a)){var b=0;a instanceof Array?b=2:a instanceof Function?b=null:a instanceof Object&&(b=1);switch(b){case 0:return e(a);case 2:var h=[];for(b=0;b<a.length;b++)h[b]=f(a[b]);return h;case 1:b={};for(h in a)Object.prototype.hasOwnProperty.call(a,h)&&(b[e(h)]=-1===g.indexOf(h)?f(a[h]):a[h]);return b}}return a};return{compressData:f,buildPOSTObject:function(){return a.stringify({cs:{dct:a.reverseEventsDictionary},events:a.eventsQueue})}}}(this)}z(c,[{key:"onBeforeUnload",value:function(){!0!==
this.unloadHandlerCalled&&(this.flush(this),this.unloadHandlerCalled=!0)}},{key:"stringify",value:function(a){try{return JSON.stringify(a)}catch(e){console.warn("Fail to stringify data")}return null}},{key:"resetBatch",value:function(){this.eventsQueue=[];this.eventsDictionary={};this.reverseEventsDictionary={};this.highPriorityTimer=this.lowPriorityTimer=this.batchSize=this.dictionaryIndex=0}},{key:"sendWithClient",value:function(a){if(null==this.endpoint||""==this.endpoint)this.ueCount("SushiClientEndpointMissing");
else{if(a.isSupported){var c=this.compressor.buildPOSTObject();return a.send(this.endpoint,c)}throw"";}}},{key:"sendWithPriority",value:function(){for(var a=arguments.length,c=Array(a),f=0;f<a;f++)c[f]=arguments[f];for(a=0;a<c.length;a++){f=c[a];try{return this.sendWithClient(f)}catch(h){}}return null}},{key:"flush",value:function(a){a.eventsQueue.length&&(a.sendWithPriority(a.transportationClient.beaconClient||{},a.transportationClient.ajaxClient||{}),a.resetBatch())}},{key:"startHighPriorityQueueTimer",
value:function(){0===this.highPriorityFlushInterval?this.flush(this):this.highPriorityTimer||(this.highPriorityTimer=this.window.setTimeout(this.flush,this.highPriorityFlushInterval,this))}},{key:"startLowPriorityQueueTimer",value:function(){this.lowPriorityTimer||(this.lowPriorityTimer=this.window.setTimeout(this.flush,this.lowPriorityFlushInterval,this))}},{key:"generateMessageId",value:function(a,c){return a+"-"+c+"-"+this.eventSequence}},{key:"getCurrentISODate",value:function(){var a=new Date,
c=function(a){return 10>a?"0"+a:a};return Date.prototype.toISOString?a.toISOString():a.getUTCFullYear()+"-"+c(a.getUTCMonth()+1)+"-"+c(a.getUTCDate())+"T"+c(a.getUTCHours())+":"+c(a.getUTCMinutes())+":"+c(a.getUTCSeconds())+"."+String((a.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}},{key:"decorateEvent",value:function(a){a.timestamp=this.getCurrentISODate();a.sequence=this.eventSequence;a.messageId=this.generateMessageId(a.request_id,Date.now?Date.now():(new Date).getTime())}},{key:"startTimers",
value:function(a){(a||{}).n?this.startHighPriorityQueueTimer():this.startLowPriorityQueueTimer()}},{key:"encodeEvent",value:function(a,c,f){c=c.length;(499===this.eventsQueue.length||524288<this.batchSize+c)&&this.flush(this);this.batchSize+=c;a={data:this.compressor.compressData(a)};this.eventsQueue.push(a);this.startTimers(f)}},{key:"addEvent",value:function(a,c){this.decorateEvent(a,c);var e=this.stringify(a);return e?(this.encodeEvent(a,e,c),!0):!1}},{key:"isValidAPIParam",value:function(a,c){return a&&
-1<a.constructor.toString().indexOf(c)}},{key:"isMaxCallsReached",value:function(){this.eventSequence++;5E4<this.eventSequence&&this.ueCount("SushiClientMaxCallsReached");return 5E4<this.eventSequence}},{key:"isValidAPICall",value:function(a,c){return!this.isMaxCallsReached()&&this.isValidAPIParam(a,"Object")}},{key:"ueCount",value:function(a,c){"undefined"!==typeof ue&&ue&&ue.count&&ue.count("BrandFollowMetrics:"+a,0===c?0:c||(ue.count("BrandFollowMetrics:"+a)||0)+1)}},{key:"processEvent",value:function(a,
c){var e=this.unloadHandlerCalled=!1;this.options=c||{};this.isValidAPICall(a,this.options)&&(e=this.addEvent(a,this.options));e?this.ueCount("ClientEventsSuccess:"+a.event_type):(console.error("Invalid JS SushiEel API call"),this.ueCount("ClientEventsFailed:"+a.event_type));return e}}]);return c}()});"use strict";m.when("A","brand-follow-sushi-client","brand-follow-constants").register("brand-follow-metrics-client",function(g,c,a){var e=g.$;g=document.domain;g=0===g.indexOf("www.amazon")||0===g.indexOf("smile.amazon");
var f=new c(l,a.SUSHI_ENDPOINT[g?"prod":"gamma"]);return{getAttributeMapFromElement:function(c){var h=e(c).data(a.BFID_DATA_KEY),f=e(c).data(a.REQUEST_ID_DATA_KEY),b=e(c).data(a.PLACEMENT_TYPE_DATA_KEY),d=e(c).data(a.PLACEMENT_SUB_TYPE_DATA_KEY),g=e(c).data(a.PLACEMENT_ID_DATA_KEY),l=e(c).data(a.COMPONENT_TYPE_DATA_KEY),m=e(c).data(a.COMPONENT_ID_DATA_KEY),n=e(c).data(a.ELEMENT_TYPE_DATA_KEY);c=e(c).data(a.ELEMENT_ID_DATA_KEY);return{bfid:h,request_id:f,placement_type:b,placement_sub_type:d,placement_id:g,
component_type:l,component_id:m,element_type:n,element_id:c}},buildFollowButtonClickMetricEvent:function(a,c,e){a=this.getAttributeMapFromElement(a);return{bfid:a.bfid,request_id:a.request_id,placement_type:a.placement_type,placement_sub_type:a.placement_sub_type,placement_id:a.placement_id,component_type:a.component_type,component_id:a.component_id,element_type:a.element_type,element_id:a.element_id,event_type:c,tooltip_status:l.brandFollowTooltipStatus,timestamp:Date.now(),event_source:l.location.href,
schema_version:1}},processMetricEvent:function(a,c){f.processEvent(a,c)}}});"use strict";m.when("A","brand-follow-constants","brand-follow-button-tooltip","brand-follow-data-storage-helper","brand-follow-csm-helper").execute("brand-follow-tooltip-helper",function(g,c,a,e,f){var h=g.$;try{localStorage.setItem("brand_follow_localStorage_testing_key","brand_follow_localStorage_testing_key");localStorage.removeItem("brand_follow_localStorage_testing_key");var p=!0}catch(t){p=!1}g.on("brandFollow:followButton:loaded",
function(){var e=c.FOLLOW_CSM_PREFIX+":tooltip";if(null!==c.PAGE_LOCALE&&c.PAGE_LOCALE!==n&&""!==c.PAGE_LOCALE&&"en"===c.PAGE_LOCALE.slice(0,2)){if(p){var r=localStorage.getItem(c.TOOLTIP_LAST_SEEN_KEY),A=localStorage.getItem(c.TOOLTIP_SEEN_COUNTER),w;if(w=k()){try{var x=a.getText()!==localStorage.getItem(c.TOOLTIP_LATEST_TEXT_KEY)}catch(C){x=!1}w=!x}if(w||!k()&&r&&!d(r,A)){l.brandFollowTooltipStatus=c.TOOLTIP_STATUS_NOT_SHOWN;return}}r=h(c.Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR);if(r.length)if(g.capabilities.mobile||
g.capabilities.tablet||screen.width<=c.BREAKPOINTS.MOBILE){var v=r.get(0);r=h(v).data(c.BFID_DATA_KEY);!r||b(r)?l.brandFollowTooltipStatus=c.TOOLTIP_STATUS_NOT_SHOWN:(a.show(v),u(),p&&localStorage.setItem(c.TOOLTIP_LATEST_TEXT_KEY,a.getText()),l.brandFollowTooltipStatus=c.TOOLTIP_STATUS_SHOWN,"true"!==l.tooltipSeenOnPage&&(q(),l.tooltipSeenOnPage="true",f.incrementCSMCounter(e+":mobile")),m(v)?y():h(l).scroll(g.throttle(function(){m(v)&&y()},200)))}else h(c.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).undelegate(c.Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR,
"mouseenter mouseleave"),h(c.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).delegate(c.Brand_FOLLOW_BUTTON_WITH_TOOLTIP_SELECTOR,"mouseenter mouseleave",function(d){if("mouseenter"===d.type){var g=h(d.target).data(c.BFID_DATA_KEY);!g||b(g)?l.brandFollowTooltipStatus=c.TOOLTIP_STATUS_NOT_SHOWN:(a.show(d.target),u(),p&&localStorage.setItem(c.TOOLTIP_LATEST_TEXT_KEY,a.getText()),l.brandFollowTooltipStatus=c.TOOLTIP_STATUS_SHOWN,"true"!==l.tooltipSeenOnPage&&(q(),l.tooltipSeenOnPage="true",f.incrementCSMCounter(e+
":desktop")))}else"mouseleave"===d.type&&a.hide()});else l.brandFollowTooltipStatus=c.TOOLTIP_STATUS_DISABLED}});var k=function(){try{return"true"===localStorage.getItem(c.FOLLOWED_BRAND_TOOLTIP_SIGNAL)}catch(t){return!1}},b=function(a){try{return c.BRAND_FOLLOW_STATUS.FOLLOWING===e.getFollowStatus(a)}catch(r){return!1}},d=function(a,b){try{return Date.now()-parseInt(a)>6048E5*Math.pow(2,parseInt(b))}catch(B){return!1}},u=function(){p&&localStorage.setItem(c.TOOLTIP_LAST_SEEN_KEY,Date.now().toString())},
m=function(a){a=a.getBoundingClientRect();return 0<=a.top&&0<=a.left&&a.bottom<=(l.innerHeight||document.documentElement.clientHeight)&&a.right<=(l.innerWidth||document.documentElement.clientWidth)},y=function(){setTimeout(function(){a.hide()},c.TOOLTIP_DISPLAY_TIME)},q=function(){if(p){var a=localStorage.getItem(c.TOOLTIP_SEEN_COUNTER);a?(a=parseInt(a)+1,localStorage.setItem(c.TOOLTIP_SEEN_COUNTER,a.toString())):localStorage.setItem(c.TOOLTIP_SEEN_COUNTER,(1).toString())}}});"use strict";m.when("A",
"brand-follow-data-storage-helper","brand-follow-constants","brand-follow-csm-helper").register("brand-follow-shared-utils",function(g,c,a,e){var f=g.$;l.BrandFollowSharedUtils={getLastClickAction:function(h){var g=a.FOLLOW_CSM_PREFIX+":sharedUtils:getLastClickAction";e.incrementCSMCounter(g);var k=a.FOLLOW_CSM_PREFIX+":sharedUtils:getBFID";e.incrementCSMCounter(k);h?"string"===typeof h?k=h:h instanceof Element&&1===h.nodeType?((h=f(h).find(a.Brand_FOLLOW_BUTTON_SELECTOR).andSelf().filter(a.Brand_FOLLOW_BUTTON_SELECTOR).first().data(a.BFID_DATA_KEY))||
e.incrementCSMCounter(k+":notFound"),k=h):(e.incrementCSMCounter(k+":unknownInput"),k=void 0):k=void 0;k||e.incrementCSMCounter(g+":emptyBFID");(k=c.getLastClickEvent(k))||e.incrementCSMCounter(g+":emptyResponse");return k},isFollowing:function(e){return c.getFollowStatus(e)===a.BRAND_FOLLOW_STATUS.FOLLOWING}}});"use strict";m.when("A","brand-follow-data-storage-helper","brand-follow-constants").register("on-brand-follow-status-change",function(g,c,a){var e=g.$;g.state.bind("brand-follow-status",
function(g,h){for(var f in h)h.hasOwnProperty(f)&&h[f]&&(c.getFollowStatus(f)===a.BRAND_FOLLOW_STATUS.FOLLOWING?e("[data-bfid\x3d'"+f+"']").each(function(){e(this).text(e(this).data(a.FOLLOWING_TEXT_DATA_KEY));e(this).attr(a.ARIA_LABEL_KEY,e(this).data(a.ARIA_LABEL_FOLLOWING_DATA_KEY))}):e("[data-bfid\x3d'"+f+"']").each(function(){e(this).text(e(this).data(a.FOLLOW_TEXT_DATA_KEY));e(this).attr(a.ARIA_LABEL_KEY,e(this).data(a.ARIA_LABEL_FOLLOW_DATA_KEY))}))})});"use strict";m.when("A").register("brand-follow-button-event-helper",
function(g){return{triggerFollowButtonLoadedEvent:function(){g.trigger("brandFollow:followButton:loaded")},triggerFollowButtonRedirectionEvent:function(c){g.trigger("brandFollow:followButton:redirectToAuthPortal",c)}}});"use strict";m.when("A","brand-follow-data-storage-helper","brand-follow-constants","brand-follow-afs-helper","brand-follow-auth-portal-link-builder","brand-follow-button-event-helper","brand-follow-metrics-client","brand-follow-csm-helper").register("brand-follow-button-click-handler",
function(g,c,a,e,f,h,p,k){var b=g.$;g.on("brandFollow:followButton:loaded",function(){b(a.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).undelegate(a.Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR,"click");b(a.Brand_FOLLOW_BUTTON_CONTAINER_SELECTOR).delegate(a.Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR,"click",function(d){var g=a.FOLLOW_CSM_PREFIX+":clickHandler";k.incrementCSMCounter(g);var m=b(this).find(a.Brand_FOLLOW_BUTTON_SELECTOR).first(),n=m.data(a.BFID_DATA_KEY),q=m.data(a.REF_DATA_KEY)||a.FOLLOW_REF_TAG;if(n){var t=
c.getFollowStatus(n);t||(t=m.data(a.FOLLOW_STATUS_DATA_KEY)?a.BRAND_FOLLOW_STATUS.FOLLOWING:a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);switch(t){case a.BRAND_FOLLOW_STATUS.FOLLOWING:k.incrementCSMCounter(g+":status:following");c.setFollowStatus(n,a.BRAND_FOLLOW_STATUS.PENDING);c.setLastClickEvent(n,a.EVENT_TYPE.UNFOLLOW);e.unfollow(n,q,function(){c.setFollowStatus(n,a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);var b=p.buildFollowButtonClickMetricEvent(m,a.EVENT_TYPE.UNFOLLOW,d);p.processMetricEvent(b,{n:1})},function(){c.setFollowStatus(n,
a.BRAND_FOLLOW_STATUS.FOLLOWING)});break;case a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING:k.incrementCSMCounter(g+":status:not_following");c.setFollowStatus(n,a.BRAND_FOLLOW_STATUS.PENDING);c.setLastClickEvent(n,a.EVENT_TYPE.FOLLOW);e.follow(n,q,function(){c.setFollowStatus(n,a.BRAND_FOLLOW_STATUS.FOLLOWING);var b=p.buildFollowButtonClickMetricEvent(m,a.EVENT_TYPE.FOLLOW,d);p.processMetricEvent(b,{n:1});try{localStorage.setItem(a.FOLLOWED_BRAND_TOOLTIP_SIGNAL,"true")}catch(B){}},function(){c.setFollowStatus(n,
a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING)},function(){h.triggerFollowButtonRedirectionEvent(d);var a=f.signin();l.location.assign(a)});break;case a.BRAND_FOLLOW_STATUS.NOT_SIGNED_IN:k.incrementCSMCounter(g+":status:not_signed_in");h.triggerFollowButtonRedirectionEvent(d);g=f.signin();l.location.assign(g);break;case a.BRAND_FOLLOW_STATUS.ERROR:k.incrementCSMCounter(g+":status:error");h.triggerFollowButtonLoadedEvent();break;case a.BRAND_FOLLOW_STATUS.PENDING:return k.incrementCSMCounter(g+":status:pending"),
!1;default:k.incrementCSMCounter(g+":status:unknown")}}else k.incrementCSMCounter(g+":emptyBFID")})})});"use strict";m.when("A","brand-follow-data-storage-helper","brand-follow-constants","brand-follow-afs-helper","brand-follow-button-event-helper","brand-follow-csm-helper","on-brand-follow-status-change","ready").register("brand-follow-button-initializer",function(g,c,a,e,f,h){g.on("brandFollow:followButton:loaded",function(){g.$(a.Brand_FOLLOW_BUTTON_WRAPPER_SELECTOR+" "+a.Brand_FOLLOW_BUTTON_SELECTOR).each(function(){var f=
g.$(this),k=f.data(a.BFID_DATA_KEY),b=f.data(a.REF_DATA_KEY)||a.FOLLOW_REF_TAG;if(k!==n){var d=c.getFollowStatus(k);if(d===n||d===a.BRAND_FOLLOW_STATUS.ERROR){d=f.data(a.FOLLOW_STATUS_DATA_KEY);if(f.data(a.BACK_BUTTON_SUPPORT_ENABLED_DATA_KEY)){var m=l.performance||l.webkitPerformance;m=m&&m.navigation&&2==m.navigation.type;!/bot|crawl|spider/i.test(l.navigator&&l.navigator.userAgent)&&m&&(d="")}if(d!==n&&""!==d)c.setFollowStatus(k,d?a.BRAND_FOLLOW_STATUS.FOLLOWING:a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);
else{c.setFollowStatus(k,a.BRAND_FOLLOW_STATUS.PENDING);var q=a.FOLLOW_CSM_PREFIX+":FetchFollowStatus";h.incrementCSMCounter(""+q);e.getFollowStatusAndInitCsrf(k,b,function(b){c.setFollowStatus(k,b.isFollowing?a.BRAND_FOLLOW_STATUS.FOLLOWING:a.BRAND_FOLLOW_STATUS.NOT_FOLLOWING);h.incrementCSMCounter(q+":success");f.data(a.FOLLOW_STATUS_DATA_KEY)!==b.isFollowing&&h.incrementCSMCounter(q+":FoundDiff")},function(){h.incrementCSMCounter(q+":error");c.setFollowStatus(k,a.BRAND_FOLLOW_STATUS.ERROR)},function(){h.incrementCSMCounter(q+
":notSignedIn");c.setFollowStatus(k,a.BRAND_FOLLOW_STATUS.NOT_SIGNED_IN)})}}else d===a.BRAND_FOLLOW_STATUS.FOLLOWING?(f.text(f.data(a.FOLLOWING_TEXT_DATA_KEY)),f.attr(a.ARIA_LABEL_KEY,f.data(a.ARIA_LABEL_FOLLOWING_DATA_KEY))):(f.text(f.data(a.FOLLOW_TEXT_DATA_KEY)),f.attr(a.ARIA_LABEL_KEY,f.data(a.ARIA_LABEL_FOLLOW_DATA_KEY)))}})});f.triggerFollowButtonLoadedEvent()});"use strict";m.when("A","brand-follow-constants","brand-follow-button-event-helper","ready").execute("brand-follow-button-mutation-observer",
function(g,c,a){var e=g.$;(function(){var f=l.MutationObserver||l.WebKitMutationObserver||l.MozMutationObserver;f!==n&&(new f(function(f,g){g=!1;for(var h=0;h<f.length;h++){var b=f[h];if("childList"!==b.type)break;b=b.addedNodes;for(var d,l=0;l<b.length;l++)if(d=b[l],0!==e(d).find(c.Brand_FOLLOW_BUTTON_SELECTOR).length){g=!0;break}if(g){a.triggerFollowButtonLoadedEvent();break}}})).observe(document,{childList:!0,subtree:!0})})()})});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("BrandFollowKataComponentAssets",""):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){});
/* ******** */
